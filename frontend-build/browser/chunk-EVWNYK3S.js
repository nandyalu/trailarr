import{a as pe,b as _e,c as fe,d as z,f as ge,g as w,h as Fe,i as Ce,l as y}from"./chunk-246NVML4.js";import{a as ce,b as O,c as me,d as h,e as A,f as Z,g as j,h as Y,i as de,j as V,k as ue}from"./chunk-TDHWVRPW.js";import{$a as q,Aa as W,Ba as B,Ca as M,Da as P,Ea as m,Fa as o,Ga as l,Ha as u,I as U,Ia as X,Ja as ee,Ka as te,L as F,M as C,Ma as Q,N as D,Na as v,Oa as ie,Pa as d,T as N,Ta as ne,U as J,Ua as re,Ya as oe,Za as c,_a as le,a as g,b as E,ba as s,c as I,ha as T,ib as f,ka as K,nb as H,ob as R,p as L,ub as se,va as p,vb as x,wa as _,wb as ae,ya as k,za as S}from"./chunk-IMRADBSH.js";var he=(()=>{class e{constructor(){this.link=x.required()}openExternalLink(t){t?.preventDefault(),window.open(this.link(),"_blank","noopener")}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275cmp=T({type:e,selectors:[["help-link-icon"]],inputs:{link:[1,"link"]},decls:2,vars:0,consts:[["xmlns","http://www.w3.org/2000/svg","viewBox","0 -960 960 960","title","Open documentation",3,"click"],["d",`M483.93-236q18.07 0 30.57-12.43t12.5-30.5q0-18.07-12.43-30.57t-30.5-12.5q-18.07 0-30.57 12.43t-12.5 30.5q0 18.07 12.43 30.57t30.5 
      12.5ZM443-389h71q0-28.32 6-51.16Q526-463 563-494q31-25 44.5-50.92t13.5-57.99q0-56.51-36.85-89.3T486.47-725q-54.47 0-93.97 
      26.5T336-625l63 24q9-27 30.5-44t53.5-17q32 0 53 17.5t21 45.5q0 22-13.71 41.5Q529.57-538 505-517q-33 28-47.5 54T443-389Zm36.54 
      325q-85.18 0-161.02-33.02t-132.16-89.34q-56.32-56.32-89.34-132.29T64-480q0-86.27 33.08-162.15 33.08-75.88 89.68-132.47 56.61-56.59 
      132.22-88.99Q394.59-896 479.56-896q86.33 0 162.51 32.39 76.18 32.4 132.56 89Q831-718 863.5-641.96q32.5 76.04 32.5 162.5 0 
      85.46-32.39 160.8-32.4 75.34-88.99 131.92Q718.03-130.16 642-97.08 565.98-64 479.54-64Z`]],template:function(n,i){n&1&&(D(),X(0,"svg",0),ie("click",function(b){return i.openExternalLink(b)}),te(1,"path",1),ee())},styles:["[_nghost-%COMP%]{display:contents}svg[_ngcontent-%COMP%]{width:1.5rem;height:1.5rem;margin:0 .5rem;fill:var(--color-info);cursor:help}"],changeDetection:0})}}return e})();var De=z(e=>{w(e.id),w(e.customfilter_id),y(e.filter_by,{message:"Filter By is required."}),y(e.filter_condition,{message:"Filter Condition is required.",when:({valueOf:r})=>r(e.filter_by)!==""}),y(e.filter_value,{message:"Filter Value is required.",when:({valueOf:r})=>{let t=r(e.filter_condition);return t===h.IS_EMPTY||t===h.IS_NOT_EMPTY?!1:r(e.filter_condition)!==""}})}),G={id:null,customfilter_id:null,filter_by:"",filter_condition:"",filter_value:""},ye=z(e=>{w(e.id),w(e.filter_type),y(e.filter_name,{message:"Filter Name is required."}),Ce(e.filter_name,100,{message:"Filter Name cannot exceed 100 characters."}),_e(e.filters,De),y(e.filters,{message:"At least one filter is required."})}),be={id:null,filter_name:"",filter_type:V.HOME,filters:[g({},G)]},Te=Object.values(ce),ke=Object.values(O),Se=Object.values(me),Me=Object.values(h);function xe(e){return e===""?[]:A.includes(e)?Te:Z.includes(e)?ke:j.includes(e)?Se:Y.includes(e)?Me:[]}function we(e,r){return A.includes(e)?"boolean":Z.includes(e)?r===O.IN_THE_LAST||r===O.NOT_IN_THE_LAST?"number_days":"date":j.includes(e)?"number":Y.includes(e)&&(r===h.IS_EMPTY||r===h.IS_NOT_EMPTY)?"none":"string"}var Ee=(()=>{class e{transform(t){return t.toLowerCase().replace(/_/g," ").replace(/\s+/g," ").trim().replace(/\b\w/g,n=>n.toUpperCase())}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275pipe=K({name:"displayTitle",type:e,pure:!0})}}return e})();var Pe=["editCustomFilterDialog"];function qe(e,r){if(e&1&&(o(0,"option",14),c(1),H(2,"displayTitle"),l()),e&2){let t=r.$implicit;m("value",t),s(),q(" ",R(2,2,t)," ")}}function Oe(e,r){if(e&1&&(o(0,"option",14),c(1),H(2,"displayTitle"),l()),e&2){let t=r.$implicit;m("value",t),s(),q(" ",R(2,2,t)," ")}}function Ve(e,r){if(e&1&&(u(0,"input",15),p()),e&2){let t=d(),n=t.$implicit,i=t.$index;m("id",f("filter_value_",i)),_(n.filter_value)}}function $e(e,r){if(e&1&&(u(0,"input",16),p()),e&2){let t=d(),n=t.$implicit,i=t.$index;m("id",f("filter_value_",i)),_(n.filter_value)}}function Ie(e,r){if(e&1&&(u(0,"input",22),p(),o(1,"span"),c(2," days"),l()),e&2){let t=d(),n=t.$implicit,i=t.$index;m("id",f("filter_value_",i)),_(n.filter_value)}}function Le(e,r){if(e&1&&(u(0,"input",17),p()),e&2){let t=d(),n=t.$implicit,i=t.$index;m("id",f("filter_value_",i)),_(n.filter_value)}}function Ne(e,r){if(e&1&&(o(0,"select",18)(1,"option",13),c(2,"Select Value"),l(),o(3,"option",23),c(4,"True"),l(),o(5,"option",24),c(6,"False"),l()(),p()),e&2){let t=d(),n=t.$implicit,i=t.$index;m("id",f("filter_value_",i)),_(n.filter_value)}}function Be(e,r){e&1&&u(0,"span")}function Qe(e,r){if(e&1){let t=Q();o(0,"div",7)(1,"select",12),v("change",function(){let i=F(t).$implicit,a=d();return C(a.onFilterByChange(i))}),o(2,"option",13),c(3,"Select Filter By"),l(),M(4,qe,3,4,"option",14,B),l(),p(),o(6,"select",12),v("change",function(){let i=F(t).$implicit,a=d();return C(a.onFilterConditionChange(i))}),o(7,"option",13),c(8,"Select Condition"),l(),M(9,Oe,3,4,"option",14,B),l(),p(),k(11,Ve,1,4,"input",15)(12,$e,1,4,"input",16)(13,Ie,3,4)(14,Le,1,4,"input",17)(15,Ne,7,4,"select",18)(16,Be,1,0,"span"),o(17,"button",19),v("click",function(){let i=F(t).$index,a=d();return C(a.removeFilter(i))}),D(),o(18,"svg",20),u(19,"path",21),l()()()}if(e&2){let t,n=r.$implicit,i=r.$index,a=d();s(),m("id",f("filter_by_",i)),_(n.filter_by),s(3),P(a.filterKeys),s(2),m("id",f("filter_condition_",i)),_(n.filter_condition),s(3),P(a.getFilterConditions(n.filter_by().value())),s(2),S((t=a.getFilterValueType(n.filter_by().value(),n.filter_condition().value()))==="string"?11:t==="number"?12:t==="number_days"?13:t==="date"?14:t==="boolean"?15:t==="none"?16:-1)}}function He(e,r){e&1&&u(0,"div",25)}function Re(e,r){if(e&1&&(o(0,"p"),c(1),l(),k(2,He,1,0,"div",25)),e&2){let t=d();oe(f("submit-result ",t.submitResult().type)),s(),le(t.submitResult().message),s(),S(t.submitResult().type==="success"?2:-1)}}var at=(()=>{class e{constructor(){this.helpLink="https://nandyalu.github.io/trailarr/user-guide/settings/profiles/filters/",this.filterType=x.required(),this.customFilter=x(null),this.dialogClosed=se(),this.customfilterService=U(ue),this.customFilterData=N(g({},be)),this.customFilterDataEffect=J(()=>{let t=this.customFilter();t&&this.customFilterData.set(g({},t))}),this.dialog=ae.required("editCustomFilterDialog"),this.filterKeys=de,this.getFilterConditions=xe,this.getFilterValueType=we,this.customFilterForm=pe(this.customFilterData,ye),this.submitResult=N({type:"success",message:""})}ngAfterViewInit(){this.openDialog()}openDialog(){this.dialog().nativeElement.showModal()}closeDialog(t){this.dialog().nativeElement.close(),setTimeout(()=>{this.dialogClosed.emit(t)},500)}addFilter(){this.customFilterData.update(t=>E(g({},t),{filters:[...t.filters,E(g({},G),{customfilter_id:t.id})]}))}removeFilter(t){this.customFilterData.update(n=>{let i=[...n.filters];return i.splice(t,1),E(g({},n),{filters:i})}),this.customFilterForm.filters().markAsDirty()}onFilterByChange(t){t.filter_condition().reset(void 0),t.filter_value().reset("")}onFilterConditionChange(t){t.filter_value().reset("")}formSubmit(t){return I(this,null,function*(){t.preventDefault(),this.submitResult.set({type:"success",message:""}),yield fe(this.customFilterForm,()=>I(this,null,function*(){let n=this.customFilterData();n.filter_type=V[this.filterType()];try{let i;n.id?i=yield L(this.customfilterService.update(n)):i=yield L(this.customfilterService.create(n)),this.submitResult.set({type:"success",message:"Filters saved successfully!"}),setTimeout(()=>{this.closeDialog(i.id)},3e3);return}catch(i){return console.error("Error submitting form:",i),this.submitResult.set({type:"error",message:"Error submitting form."+i.message}),Fe({message:"An error occurred while submitting the form. Please try again."})}}))})}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275cmp=T({type:e,selectors:[["edit-filter-dialog"]],viewQuery:function(n,i){n&1&&ne(i.dialog,Pe,5),n&2&&re()},inputs:{filterType:[1,"filterType"],customFilter:[1,"customFilter"]},outputs:{dialogClosed:"dialogClosed"},decls:19,vars:6,consts:[["editCustomFilterDialog",""],[3,"click","submit"],[1,"top-right",3,"link"],[1,"form-group"],["for","filter_name"],["id","filter_name",3,"field"],[1,"filters-container"],[1,"filter-group"],["type","button",1,"secondary",3,"click"],[1,"buttons-row"],["type","submit",1,"primary",3,"disabled"],["type","button",1,"danger",3,"click"],[3,"change","id","field"],["value","","disabled",""],[3,"value"],["type","text",3,"id","field"],["type","number",3,"id","field"],["type","date",3,"id","field"],[3,"id","field"],["type","button",1,"danger","icononly-button",3,"click"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 -960 960 960"],["d","M253-99q-38.21 0-65.11-26.6Q161-152.2 161-190v-552h-58v-91h228v-47h297v47h228v91h-58v552q0 37.18-27.21 64.09Q743.59-99 706-99H253Zm453-643H253v552h453v-552ZM357-268h74v-398h-74v398Zm173 0h75v-398h-75v398ZM253-742v552-552Z"],["type","number","placeholder","days",3,"id","field"],["value","true"],["value","false"],[1,"close-progress"]],template:function(n,i){if(n&1){let a=Q();o(0,"dialog",null,0)(2,"form",1),v("click",function($){return F(a),C($.stopPropagation())})("submit",function($){return F(a),C(i.formSubmit($))}),u(3,"help-link-icon",2),o(4,"div",3)(5,"label",4),c(6,"Label"),l(),u(7,"input",5),p(),l(),o(8,"div",6),M(9,Qe,20,9,"div",7,W),o(11,"button",8),v("click",function(){return F(a),C(i.addFilter())}),c(12,"Add Filter"),l()(),o(13,"div",9)(14,"button",10),c(15),l(),o(16,"button",11),v("click",function(){return F(a),C(i.closeDialog(-1))}),c(17,"Cancel"),l()()(),k(18,Re,3,5),l()}n&2&&(s(3),m("link",i.helpLink),s(4),_(i.customFilterForm.filter_name),s(2),P(i.customFilterForm.filters),s(5),m("disabled",!i.customFilterForm().dirty()||i.customFilterForm().invalid()||i.customFilterForm().submitting()),s(),q(" ",i.customFilterForm().submitting()?"Saving...":i.customFilter()?"Update":"Create"," "),s(3),S(i.submitResult().message?18:-1))},dependencies:[he,ge,Ee],styles:["form[_ngcontent-%COMP%]{padding:1rem;display:block flex;flex-direction:column;gap:1rem;position:relative}.top-right[_ngcontent-%COMP%]{position:absolute;top:1rem;right:1rem;display:block}label[_ngcontent-%COMP%]{display:block;margin-bottom:.4rem;font-weight:700}input[_ngcontent-%COMP%], select[_ngcontent-%COMP%]{padding:.5rem;box-sizing:border-box}option[_ngcontent-%COMP%]{background-color:var(--color-surface-container-high)}.ng-touched.ng-invalid[_ngcontent-%COMP%]:not(form):not(div){border:2px solid var(--color-danger)}.filters-container[_ngcontent-%COMP%]{border-top:1px solid var(--color-outline);padding-top:1rem}.filter-group[_ngcontent-%COMP%]{display:block flex;flex-wrap:wrap;gap:1rem;align-items:center;border:1px solid var(--color-outline);border-radius:.5rem;padding:.5rem;margin-bottom:.75rem;background-color:var(--color-surface-container-high)}.filter-group[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(3){flex:1;text-align:start}.danger[_ngcontent-%COMP%]{width:auto;height:auto}.danger[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--color-danger-text)}.submit-result[_ngcontent-%COMP%]{margin:0 auto .5rem;font-size:1rem;font-weight:700;white-space:normal;color:var(--color-success-text)}.submit-result.error[_ngcontent-%COMP%]{max-width:min-content;color:var(--color-danger-text)}.close-progress[_ngcontent-%COMP%]{width:100%;height:.25rem;background-color:var(--color-success-text);border-radius:.25rem;animation:_ngcontent-%COMP%_closeProgress 3s linear 0s}@keyframes _ngcontent-%COMP%_closeProgress{0%{width:100%}to{width:0%}}"],changeDetection:0})}}return e})();export{he as a,at as b};
