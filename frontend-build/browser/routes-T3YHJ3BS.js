import{a as me}from"./chunk-S4NF5G2M.js";import{a as J}from"./chunk-N37SD2EC.js";import{a as ge,b as de}from"./chunk-YAJXZVPW.js";import{E as w,a as K,c as X,d as Y,e as ee,f as te,g as oe,h as ne,l as ie,q as re,r as le,s as ae,y as se,z as ce}from"./chunk-WYABKN6O.js";import{a as pe}from"./chunk-U3IUXOJU.js";import{Fb as j,Hb as R,I as T,Ia as l,Ib as d,Ic as W,Jb as v,Kb as b,Kc as A,L as E,Lc as S,Mb as U,Nb as $,Ob as G,Tb as O,Wa as N,Yb as P,Zb as q,_ as k,cc as H,da as h,dc as B,fb as C,gb as f,ib as I,ja as Z,jb as y,ka as D,kb as x,la as m,lb as L,ma as F,mb as r,nb as i,ob as c,pa as Q,sa as _,tb as V,vb as M,vc as z,xb as u}from"./chunk-23TJMG7J.js";var ue=(()=>{let o=class o{constructor(){this.http=h(W),this.logsUrl=`${S.apiUrl}${S.logs}`,this.downloadLogs=()=>this.http.get(this.logsUrl+"download",{responseType:"blob"}),this.getLogs=()=>this.http.get(this.logsUrl),this.getRawLogs=()=>this.http.get(this.logsUrl+"raw")}};o.\u0275fac=function(s){return new(s||o)},o.\u0275prov=k({token:o,factory:o.\u0275fac,providedIn:"root"});let e=o;return e})();var Ce=(e,o)=>o.id;function fe(e,o){if(e&1&&(r(0,"option",7),d(1),P(2,"titlecase"),i()),e&2){let n=o.$implicit,t=u();L("value",n)("selected",t.selectedLogLevel()===n),l(),v(q(2,3,n))}}function Le(e,o){e&1&&c(0,"app-load-indicator",12)}function Me(e,o){e&1&&(m(),r(0,"svg",18),c(1,"path",22),i())}function we(e,o){e&1&&(m(),r(0,"svg",18),c(1,"path",23),i())}function ye(e,o){e&1&&(m(),r(0,"svg",18),c(1,"path",24),i())}function xe(e,o){e&1&&(m(),r(0,"svg",18),c(1,"path",25),i())}function be(e,o){e&1&&(m(),r(0,"svg",18),c(1,"path",26),i())}function Oe(e,o){if(e&1&&(r(0,"details",21)(1,"summary")(2,"small"),d(3,"Exception Details (click to show/hide)"),i()(),r(4,"pre",27),d(5),i()()),e&2){let n=u().$implicit;l(5),v(n.traceback)}}function Pe(e,o){if(e&1&&(r(0,"div",15)(1,"details")(2,"summary")(3,"p",16)(4,"i",17),C(5,Me,2,0,":svg:svg",18)(6,we,2,0,":svg:svg",18)(7,ye,2,0,":svg:svg",18)(8,xe,2,0,":svg:svg",18)(9,be,2,0,":svg:svg",18),i(),r(10,"strong"),d(11),i(),d(12),i(),r(13,"small",19),d(14),P(15,"timeago"),i()(),r(16,"p",20),d(17),i(),C(18,Oe,6,1,"details",21),i()()),e&2){let n=o.$implicit,t=u(2);l(3),R(O("logs-text ",n.level.toLowerCase())),L("title",O("",n.level.toLowerCase()," log")),l(2),f(n.level===t.logLevels.Info?5:n.level===t.logLevels.Debug?6:n.level===t.logLevels.Warning?7:n.level===t.logLevels.Error||n.level===t.logLevels.Exception||n.level===t.logLevels.Critical?8:9),l(6),b("",n.loggername,": "),l(),b("",n.message," "),l(2),v(q(15,11,n.created)),l(3),v(t.getRawLog(n)),l(),f(n.traceback?18:-1)}}function qe(e,o){if(e&1){let n=V();r(0,"div",14),M("nearEnd",function(){Z(n);let s=u();return D(s.loadMore())}),y(1,Pe,19,13,"div",15,Ce),i()}if(e&2){let n=u();l(),x(n.filteredLogs())}}var ve=(()=>{let o=class o{constructor(){this.destroyRef=h(Q),this.logsService=h(ue),this.title="Logs",this.logLevels=w,this.allLogLevels=Object.values(w),this.searchForm=new te,this.displayCount=_(100),this.allLogs=A(()=>({url:this.logsService.logsUrl+"raw",method:"GET",params:{level:this.selectedLogLevel().toUpperCase(),limit:this.limit()}}),{defaultValue:[]}),this.searchQuery=_(""),this.selectedLogLevel=_(w.Info),this.limit=_(1e3),this.filteredLogs=H(()=>{let t=this.searchQuery(),s=this.allLogs.value();return!t||t.length<3?s.slice(0,this.displayCount()):s.filter(a=>Object.values(a).map(he=>he?.toString()||"").join(" | ").toLowerCase().includes(t.toLowerCase()))}),this.resetDisplayCount=B(()=>{this.searchQuery().length<3&&this.displayCount.set(100),this.selectedLogLevel(),this.displayCount.set(100)})}ngOnInit(){this.searchForm.valueChanges.pipe(T(400),E(),J(this.destroyRef)).subscribe(t=>{this.searchQuery.set(t)})}getRawLog(t){return`${t.created}: [${t.level}|${t.filename}|${t.lineno}] ${t.loggername} ${t.message}`}downloadLogs(){let t=this.filteredLogs().map(p=>this.getRawLog(p)).join(`
`),s=new Blob([t],{type:"text/plain"}),a=window.URL.createObjectURL(s),g=document.createElement("a");g.href=a,g.download=`trailarr-logs-${new Date().toISOString()}.txt`,document.body.appendChild(g),g.click(),document.body.removeChild(g),window.URL.revokeObjectURL(a)}loadMore(){let t=this.displayCount();if(t>=this.allLogs.value().length){this.limit.update(s=>s+1e3);return}this.displayCount.set(t+30)}};o.\u0275fac=function(s){return new(s||o)},o.\u0275cmp=N({type:o,selectors:[["app-logs"]],decls:17,vars:6,consts:[[1,"logs-container"],[1,"logs-title","text-center"],[1,"logssearch"],["title","Refresh",1,"icononly-button",3,"click"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 -960 960 960",1,"refresh-icon"],["d","M343-107q-120-42-194.5-146.5T74-490q0-29 4-57.5T91-604l-57 33-37-62 185-107 106 184-63 36-54-92q-13 30-18.5 60.5T147-490q0 113 65.5 200T381-171l-38 64Zm291-516v-73h107q-47-60-115.5-93.5T480-823q-66 0-123.5 24T255-734l-38-65q54-45 121-71t142-26q85 0 160.5 33T774-769v-67h73v213H634ZM598-1 413-107l107-184 62 37-54 94q123-17 204.5-110.5T814-489q0-19-2.5-37.5T805-563h74q4 18 6 36.5t2 36.5q0 142-87 251.5T578-96l56 33-36 62Z"],["name","logs-type","id","logs-type-select",1,"logs-type-select",3,"ngModelChange","ngModel"],[3,"value","selected"],["id","searchForm",1,"logssearch-form"],["type","search","autocomplete","off","name","query","placeholder","Filter logs...","aria-label","filter logs",3,"formControl"],["title","Download Logs",1,"icononly-button",3,"click"],["d","M480-313 287-506l43-43 120 120v-371h60v371l120-120 43 43-193 193ZM220-160q-24 0-42-18t-18-42v-143h60v143h520v-143h60v143q0 24-18 42t-42 18H220Z"],[1,"center"],["appScrollNearEnd","",1,"logs-table"],["appScrollNearEnd","",1,"logs-table",3,"nearEnd"],[1,"logs-row"],[3,"title"],[1,"logs-icon"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 -960 960 960"],[1,"logs-dt"],[1,"logs-raw"],[1,"logs-details"],["d","M453-280h60v-240h-60v240Zm26.98-314q14.02 0 23.52-9.2T513-626q0-14.45-9.48-24.22-9.48-9.78-23.5-9.78t-23.52 9.78Q447-640.45 447-626q0 13.6 9.48 22.8 9.48 9.2 23.5 9.2Zm.29 514q-82.74 0-155.5-31.5Q252-143 197.5-197.5t-86-127.34Q80-397.68 80-480.5t31.5-155.66Q143-709 197.5-763t127.34-85.5Q397.68-880 480.5-880t155.66 31.5Q709-817 763-763t85.5 127Q880-563 880-480.27q0 82.74-31.5 155.5Q817-252 763-197.68q-54 54.31-127 86Q563-80 480.27-80Zm.23-60Q622-140 721-239.5t99-241Q820-622 721.19-721T480-820q-141 0-240.5 98.81T140-480q0 141 99.5 240.5t241 99.5Zm-.5-340Z"],["d","M320-242 80-482l242-242 43 43-199 199 197 197-43 43Zm318 2-43-43 199-199-197-197 43-43 240 240-242 242Z"],["d","m40-120 440-760 440 760H40Zm104-60h672L480-760 144-180Zm340.18-57q12.82 0 21.32-8.68 8.5-8.67 8.5-21.5 0-12.82-8.68-21.32-8.67-8.5-21.5-8.5-12.82 0-21.32 8.68-8.5 8.67-8.5 21.5 0 12.82 8.68 21.32 8.67 8.5 21.5 8.5ZM454-348h60v-224h-60v224Zm26-122Z"],["d","M479.91-120q-28.91 0-49.41-20.59-20.5-20.59-20.5-49.5t20.59-49.41q20.59-20.5 49.5-20.5t49.41 20.59q20.5 20.59 20.5 49.5t-20.59 49.41q-20.59 20.5-49.5 20.5ZM410-360v-480h140v480H410Z"],["d","M477.03-246Q493-246 504-257.03q11-11.03 11-27T503.97-311q-11.03-11-27-11T450-310.97q-11 11.03-11 27T450.03-257q11.03 11 27 11ZM444-394h57q0-31 10-50.5t34.72-44.22Q579-522 592-547.5t13-53.5q0-53-34-84t-91.52-31q-51.87 0-88.17 24.5Q355-667 338-624l53 22q14-28 36.2-42.5Q449.4-659 479-659q32 0 50.5 16t18.5 44.1q0 19.9-11 38.4T500-517q-37 35-46.5 60t-9.5 63ZM180-120q-24 0-42-18t-18-42v-600q0-24 18-42t42-18h600q24 0 42 18t18 42v600q0 24-18 42t-42 18H180Zm0-60h600v-600H180v600Zm0-600v600-600Z"],[1,"logs-pre"]],template:function(s,a){s&1&&(r(0,"div",0)(1,"h1",1),d(2),i(),r(3,"div",2)(4,"i",3),M("click",function(){return a.allLogs.reload()}),m(),r(5,"svg",4),c(6,"path",5),i()(),F(),r(7,"select",6),G("ngModelChange",function(p){return $(a.selectedLogLevel,p)||(a.selectedLogLevel=p),p}),y(8,fe,3,5,"option",7,I),i(),r(10,"form",8),c(11,"input",9),i(),r(12,"a",10),M("click",function(){return a.downloadLogs()}),m(),r(13,"svg",4),c(14,"path",11),i()()(),C(15,Le,1,0,"app-load-indicator",12)(16,qe,3,0,"div",13),i()),s&2&&(l(2),v(a.title),l(2),j("loading",a.allLogs.isLoading()),l(3),U("ngModel",a.selectedLogLevel),l(),x(a.allLogLevels),l(3),L("formControl",a.searchForm),l(4),f(a.allLogs.isLoading()&&a.allLogs.value().length===0?15:16))},dependencies:[se,ne,le,ae,K,re,X,Y,oe,ee,pe,ce,ie,me,de,ge,z],styles:[".logs-container[_ngcontent-%COMP%]{display:flex;flex-direction:column}.logs-title[_ngcontent-%COMP%]{position:sticky;top:76px;margin:0;padding:1rem;background-color:var(--color-surface-container-high);z-index:2}@media (width < 765px){.logs-title[_ngcontent-%COMP%]{top:62px}}.text-center[_ngcontent-%COMP%]{text-align:center}.logssearch[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:center;width:auto;flex-grow:1;padding:1rem;background-color:var(--color-surface-container-high);position:sticky;top:145px;z-index:2;gap:.5rem}@media (width < 765px){.logssearch[_ngcontent-%COMP%]{padding:.5rem;top:113px}}.refresh-icon[_ngcontent-%COMP%]{cursor:pointer;fill:var(--color-on-surface)}.loading[_ngcontent-%COMP%]{cursor:progress;animation:spin-animation 2s linear infinite}.logs-type-select[_ngcontent-%COMP%]{width:10rem;padding:.5rem;border:1px solid var(--color-outline);border-radius:.5rem;background-color:var(--color-surface-container-highest);color:var(--color-on-surface);font-size:1rem}.logs-type-select[_ngcontent-%COMP%]:focus{outline:var(--color-primary);border:1px solid var(--color-primary)}.logssearch-form[_ngcontent-%COMP%]{width:100%}.logssearch-form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:.5rem;border:1px solid var(--color-outline);border-radius:.5rem;margin:0;font-size:1rem;background-color:var(--color-surface-container-highest);color:var(--color-on-surface)}.logssearch-form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:var(--color-primary);border:1px solid var(--color-primary)}.logs-table[_ngcontent-%COMP%]{padding:1rem}.logs-row[_ngcontent-%COMP%]{padding:10px;border-bottom:1px solid #e0e0e0}@media (width < 765px){.logs-row[_ngcontent-%COMP%]{padding:0}}.logs-row[_ngcontent-%COMP%]   details[_ngcontent-%COMP%]{width:100%;list-style-position:outside}.logs-row[_ngcontent-%COMP%]   summary[_ngcontent-%COMP%]{list-style-position:outside;display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:1rem;cursor:pointer;position:relative}@media (width < 765px){.logs-row[_ngcontent-%COMP%]   summary[_ngcontent-%COMP%]{flex-direction:column;align-items:baseline;gap:0;margin-bottom:1rem}}summary[_ngcontent-%COMP%]   .logs-text[_ngcontent-%COMP%]{flex:1;margin-left:2rem}.logs-pre[_ngcontent-%COMP%]{text-wrap:auto;white-space:pre-wrap;word-break:break-word;margin:.5rem 0;padding:1rem;border-radius:1rem;background-color:var(--color-surface-container-highest)}.logs-icon[_ngcontent-%COMP%]{position:absolute;top:.75rem;left:0;font-size:0;z-index:0}.logs-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:1.5rem;fill:var(--color-outline)}summary[_ngcontent-%COMP%]   .debug[_ngcontent-%COMP%]{color:var(--color-info)}summary[_ngcontent-%COMP%]   .debug[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--color-info)}summary[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]{color:var(--color-danger)}summary[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--color-danger)}summary[_ngcontent-%COMP%]   .error[_ngcontent-%COMP%]{color:var(--color-warning)}summary[_ngcontent-%COMP%]   .error[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--color-warning)}"],changeDetection:0});let e=o;return e})();var Ke=[{path:"",loadComponent:()=>ve}];export{Ke as default};
