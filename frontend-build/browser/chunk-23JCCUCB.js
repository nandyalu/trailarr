import{a as L,b as M,c as ce,d as me,e as x,f as E,g as D,h as P,i as h,j as ue}from"./chunk-BCMX5QMB.js";import{a as z,b as g,c as K,d as J,h as W,i as X,m as Y,n as ee,o as te,p as ie,q as ne,r as oe,s as re,v as le,x as ae,y as se,z as de}from"./chunk-CGZER6MH.js";import{a as pe}from"./chunk-CMGRYTU6.js";import{Aa as N,Ba as C,Ca as Z,Da as l,H as A,Ha as j,Ia as R,J as p,K as _,L as F,Na as m,P as I,Pa as V,S as $,Ya as f,_ as d,da as b,fb as q,ib as y,jb as U,ma as T,na as S,oa as B,pa as O,qa as w,ra as k,sa as s,ta as o,ua as r,va as c,wa as G,xa as Q,ya as H}from"./chunk-2I2MBWCP.js";var _e=(()=>{class i{constructor(){this.link=y.required()}openExternalLink(e){e?.preventDefault(),window.open(this.link(),"_blank","noopener")}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275cmp=b({type:i,selectors:[["help-link-icon"]],inputs:{link:[1,"link"]},decls:2,vars:0,consts:[["xmlns","http://www.w3.org/2000/svg","viewBox","0 -960 960 960","title","Open documentation",3,"click"],["d",`M483.93-236q18.07 0 30.57-12.43t12.5-30.5q0-18.07-12.43-30.57t-30.5-12.5q-18.07 0-30.57 12.43t-12.5 30.5q0 18.07 12.43 30.57t30.5 
      12.5ZM443-389h71q0-28.32 6-51.16Q526-463 563-494q31-25 44.5-50.92t13.5-57.99q0-56.51-36.85-89.3T486.47-725q-54.47 0-93.97 
      26.5T336-625l63 24q9-27 30.5-44t53.5-17q32 0 53 17.5t21 45.5q0 22-13.71 41.5Q529.57-538 505-517q-33 28-47.5 54T443-389Zm36.54 
      325q-85.18 0-161.02-33.02t-132.16-89.34q-56.32-56.32-89.34-132.29T64-480q0-86.27 33.08-162.15 33.08-75.88 89.68-132.47 56.61-56.59 
      132.22-88.99Q394.59-896 479.56-896q86.33 0 162.51 32.39 76.18 32.4 132.56 89Q831-718 863.5-641.96q32.5 76.04 32.5 162.5 0 
      85.46-32.39 160.8-32.4 75.34-88.99 131.92Q718.03-130.16 642-97.08 565.98-64 479.54-64Z`]],template:function(t,n){t&1&&(F(),G(0,"svg",0),Z("click",function(v){return n.openExternalLink(v)}),H(1,"path",1),Q())},styles:["[_nghost-%COMP%]{display:contents}svg[_ngcontent-%COMP%]{width:1.5rem;height:1.5rem;margin:0 .5rem;fill:var(--color-info);cursor:help}"],changeDetection:0})}}return i})();var ge=["customFilterDialog"];function Ce(i,a){i&1&&c(0,"app-load-indicator",1)}function he(i,a){if(i&1&&(o(0,"option",17),m(1),r()),i&2){let e=a.$implicit,t=l(3);s("value",e),d(),V(" ",t.displayTitle(e)," ")}}function ve(i,a){if(i&1&&(o(0,"option",17),m(1),r()),i&2){let e=a.$implicit,t=l(3);s("value",e),d(),V(" ",t.displayTitle(e)," ")}}function Fe(i,a){if(i&1&&c(0,"input",19),i&2){let e=l().$index;s("id",f("filter_value_",e))}}function ye(i,a){if(i&1&&c(0,"input",20),i&2){let e=l().$index;s("id",f("filter_value_",e))}}function xe(i,a){if(i&1&&(c(0,"input",26),o(1,"span"),m(2," days"),r()),i&2){let e=l().$index;s("id",f("filter_value_",e))}}function be(i,a){if(i&1&&c(0,"input",21),i&2){let e=l().$index;s("id",f("filter_value_",e))}}function Te(i,a){if(i&1&&(o(0,"select",22)(1,"option",27),m(2,"True"),r(),o(3,"option",28),m(4,"False"),r()()),i&2){let e=l().$index;s("id",f("filter_value_",e))}}function Se(i,a){if(i&1){let e=N();o(0,"div",9)(1,"div",5)(2,"select",15),C("change",function(n){let u=p(e).$index,v=l(2);return _(v.onFilterByChange(n,u))}),o(3,"option",16),m(4,"Select Filter By"),r(),w(5,he,2,2,"option",17,O),r()(),o(7,"div",5)(8,"select",18),C("change",function(n){let u=p(e).$index,v=l(2);return _(v.onFilterConditionChange(n,u))}),o(9,"option",16),m(10,"Select Condition"),r(),w(11,ve,2,2,"option",17,O),r()(),o(13,"div",5),T(14,Fe,1,2,"input",19)(15,ye,1,2,"input",20)(16,xe,3,2)(17,be,1,2,"input",21)(18,Te,5,2,"select",22),r(),o(19,"button",23),C("click",function(){let n=p(e).$index,u=l(2);return _(u.removeFilter(n))}),F(),o(20,"svg",24),c(21,"path",25),r()()()}if(i&2){let e=a.$index,t=l(2);s("formGroupName",e),d(2),s("id",f("filter_by_",e)),d(3),k(t.filterKeys),d(3),s("id",f("filter_condition_",e)),d(3),k(t.filterConditions[e]),d(3),S(t.filterValueTypes[e]==="string"?14:t.filterValueTypes[e]==="number"?15:t.filterValueTypes[e]==="number_days"?16:t.filterValueTypes[e]==="date"?17:t.filterValueTypes[e]==="boolean"?18:-1)}}function we(i,a){if(i&1&&(o(0,"button",13),m(1),r()),i&2){let e=l(2);s("disabled",e.customFilterForm.pristine||e.customFilterForm.invalid||e.submitting),d(),V(" ",e.customFilter()?"Update":"Create"," ")}}function ke(i,a){i&1&&(o(0,"div",14),F(),o(1,"svg",29)(2,"circle",30),c(3,"animate",31),r(),o(4,"circle",32),c(5,"animate",33),r(),o(6,"circle",34),c(7,"animate",35),r()()())}function Ve(i,a){if(i&1){let e=N();o(0,"form",3),C("ngSubmit",function(){p(e);let n=l();return _(n.onSubmit())})("click",function(n){return p(e),_(n.stopPropagation())}),c(1,"help-link-icon",4),o(2,"div",5)(3,"label",6),m(4,"Label"),r(),c(5,"input",7),r(),o(6,"div",8),w(7,Se,22,6,"div",9,B),o(9,"button",10),C("click",function(){p(e);let n=l();return _(n.addFilter())}),m(10,"Add Filter"),r()(),o(11,"div",11)(12,"button",12),C("click",function(){p(e);let n=l();return _(n.closeDialog(-1))}),m(13,"Cancel"),r(),T(14,we,2,2,"button",13)(15,ke,8,0,"div",14),r()()}if(i&2){let e=l();s("formGroup",e.customFilterForm),d(),s("link",e.helpLink),d(6),k(e.filters.controls),d(7),S(e.submitting?15:14)}}var Qe=(()=>{class i{constructor(){this.fb=A(ae),this.helpLink="https://nandyalu.github.io/trailarr/user-guide/settings/profiles/filters/",this.filterType=y.required(),this.filterTypeValue=q(()=>{let e=this.filterType().toUpperCase();return e=="MOVIES"?h.MOVIES:e=="SERIES"?h.SERIES:e=="TRAILER"?h.TRAILER:h.HOME}),this.customFilter=y(null),this.dialogClosed=new I,this.isLoading=!0,this.customfilterService=A(ue),this.computedSignal=q(()=>{let e=this.customFilter();return this.initForm(e),!0}),this.boolFilterConditions=Object.values(L),this.dateFilterConditions=Object.values(M),this.numberFilterConditions=Object.values(ce),this.stringFilterConditions=Object.values(me),this.filterConditions=[],this.filterValueTypes=[],this.filterKeys=x.concat(E,D,P).sort(),this.viewForOptions=Object.values(h),this.customFilterDialog=U.required("customFilterDialog"),this.submitting=!1,$(()=>{this.initForm(this.customFilter())})}ngAfterViewInit(){this.customFilterDialog().nativeElement.showModal()}closeDialog(e){this.customFilterDialog().nativeElement.close(),this.dialogClosed.emit(e),this.filters.clear(),this.addFilter(),this.customFilterForm.reset()}displayTitle(e){return e.toLowerCase().replace(/_/g," ").replace(/\b\w/g,t=>t.toUpperCase())}initForm(e){let t=this.fb.group({id:[e?e.id:null],filter_type:[e?e.filter_type:this.filterTypeValue(),g.required],filter_name:[e?e.filter_name:"",[g.required,g.maxLength(100)]],filters:this.fb.array([],g.required)});return this.customFilterForm=t,e&&e.filters&&e.filters.length?e.filters.forEach(n=>{this.addFilter(n)}):this.addFilter(),this.isLoading=!1,t}get filters(){return this.customFilterForm.get("filters")}createFilter(e){return this.fb.group({id:[e?e.id:null],filter_by:[e?e.filter_by:"",g.required],filter_condition:[e?e.filter_condition:"",g.required],filter_value:[e?e.filter_value:"",g.required],customfilter_id:[e?e.customfilter_id:null]})}getFilterConditions(e){return x.includes(e)?this.boolFilterConditions:E.includes(e)?this.dateFilterConditions:D.includes(e)?this.numberFilterConditions:P.includes(e)?this.stringFilterConditions:[]}getFilterValueType(e,t){return x.includes(e)?"boolean":E.includes(e)?t===M.IN_THE_LAST||t===M.NOT_IN_THE_LAST?"number_days":"date":D.includes(e)?"number":"string"}addFilter(e){e&&e.filter_by?(this.filterConditions.push(this.getFilterConditions(e.filter_by)),this.filterValueTypes.push(this.getFilterValueType(e.filter_by,e.filter_condition))):(this.filterConditions.push([]),this.filterValueTypes.push("string")),this.filters.push(this.createFilter(e))}removeFilter(e){this.filterConditions.splice(e,1),this.filters.removeAt(e)}onFilterByChange(e,t){let n=this.filters.at(t).get("filter_by")?.value;this.filterConditions[t]=this.getFilterConditions(n),this.filterValueTypes[t]=this.getFilterValueType(n,""),this.filters.at(t).get("filter_condition")?.setValue(""),x.includes(n)&&this.filters.at(t).get("filter_condition")?.setValue(L.EQUALS),this.filters.at(t).get("filter_value")?.reset()}onFilterConditionChange(e,t){let n=this.filters.at(t).get("filter_by")?.value;if(e.target){let u=e.target.value;this.filterValueTypes[t]=this.getFilterValueType(n,u)}this.filters.at(t).get("filter_value")?.reset()}onSubmit(){if(!this.submitting)if(this.submitting=!0,this.customFilterForm.valid){let e=this.customFilterForm.value;e.filters.forEach(t=>{t.filter_value=t.filter_value.toString()}),this.customFilter()?.id?this.customfilterService.update(e).subscribe(t=>{this.closeDialog(t.id),this.submitting=!1}):this.customfilterService.create(e).subscribe(t=>{this.closeDialog(t.id),this.submitting=!1})}else console.log("Form is invalid"),this.customFilterForm.markAllAsTouched(),this.submitting=!1}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275cmp=b({type:i,selectors:[["app-add-filter-dialog"]],viewQuery:function(t,n){t&1&&j(n.customFilterDialog,ge,5),t&2&&R()},inputs:{filterType:[1,"filterType"],customFilter:[1,"customFilter"]},outputs:{dialogClosed:"dialogClosed"},decls:4,vars:1,consts:[["customFilterDialog",""],[1,"center"],[3,"formGroup"],[3,"ngSubmit","click","formGroup"],[1,"top-right",3,"link"],[1,"form-group"],["for","filter_name"],["id","filter_name","type","text","maxlength","100","formControlName","filter_name"],["formArrayName","filters",1,"filters-container"],[1,"filter-group",3,"formGroupName"],["type","button",1,"secondary",3,"click"],[1,"buttons-row"],["type","button",1,"danger",3,"click"],["type","submit",1,"primary",3,"disabled"],["title","Submitting form data"],["formControlName","filter_by",3,"change","id"],["value","","disabled",""],[3,"value"],["formControlName","filter_condition",3,"change","id"],["type","text","formControlName","filter_value",3,"id"],["type","number","formControlName","filter_value",3,"id"],["type","date","formControlName","filter_value",3,"id"],["formControlName","filter_value",3,"id"],["type","button",1,"danger","icononly-button",3,"click"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 -960 960 960"],["d","M253-99q-38.21 0-65.11-26.6Q161-152.2 161-190v-552h-58v-91h228v-47h297v47h228v91h-58v552q0 37.18-27.21 64.09Q743.59-99 706-99H253Zm453-643H253v552h453v-552ZM357-268h74v-398h-74v398Zm173 0h75v-398h-75v398ZM253-742v552-552Z"],["type","number","placeholder","days","formControlName","filter_value",3,"id"],["value","true"],["value","false"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 200 200",1,"icon-loading"],["stroke-width","14","r","15","cx","40","cy","65"],["attributeName","cy","calcMode","spline","dur","2","values","65;135;65;","keySplines",".5 0 .5 1;.5 0 .5 1","repeatCount","indefinite","begin","-.4"],["stroke-width","14","r","15","cx","100","cy","65"],["attributeName","cy","calcMode","spline","dur","2","values","65;135;65;","keySplines",".5 0 .5 1;.5 0 .5 1","repeatCount","indefinite","begin","-.2"],["stroke-width","14","r","15","cx","160","cy","65"],["attributeName","cy","calcMode","spline","dur","2","values","65;135;65;","keySplines",".5 0 .5 1;.5 0 .5 1","repeatCount","indefinite","begin","0"]],template:function(t,n){t&1&&(o(0,"dialog",null,0),T(2,Ce,1,0,"app-load-indicator",1)(3,Ve,16,3,"form",2),r()),t&2&&(d(2),S(n.isLoading?2:3))},dependencies:[se,W,oe,re,z,X,ne,K,J,le,_e,pe,de,ie,te,Y,ee],styles:["[_nghost-%COMP%]{display:contents}.center[_ngcontent-%COMP%]{margin:auto}form[_ngcontent-%COMP%]{padding:1rem;display:block flex;flex-direction:column;gap:1rem;position:relative}.top-right[_ngcontent-%COMP%]{position:absolute;top:1rem;right:1rem;display:block}label[_ngcontent-%COMP%]{display:block;margin-bottom:.4rem;font-weight:700}input[_ngcontent-%COMP%], select[_ngcontent-%COMP%]{padding:.5rem;box-sizing:border-box}option[_ngcontent-%COMP%]{background-color:var(--color-surface-container-high)}.ng-touched.ng-invalid[_ngcontent-%COMP%]:not(form):not(div){border:2px solid var(--color-danger)}.error[_ngcontent-%COMP%]{color:var(--color-danger);font-size:.9rem;margin-top:.4rem}.filters-container[_ngcontent-%COMP%]{border-top:1px solid var(--color-outline);padding-top:1rem}.filter-group[_ngcontent-%COMP%]{display:block flex;flex-wrap:wrap;gap:1rem;align-items:center;border:1px solid var(--color-outline);border-radius:.5rem;padding:.5rem;margin-bottom:.75rem;background-color:var(--color-surface-container-high)}.filter-group[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(3){flex:1;text-align:start}.danger[_ngcontent-%COMP%]{width:auto;height:auto}.danger[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--color-danger-text)}.buttons-row[_ngcontent-%COMP%]{display:block flex;align-items:center;justify-content:space-around}.icon-loading[_ngcontent-%COMP%]{width:1.5rem;height:1.5rem;fill:var(--color-on-surface)}"]})}}return i})();export{_e as a,Qe as b};
